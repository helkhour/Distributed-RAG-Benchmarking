=== Evaluating Model: sentence-transformers/all-mpnet-base-v2 ===
2025-05-06 16:19:33,978 - INFO - Running sequential embedding mode
2025-05-06 16:19:33,980 - INFO - Use pytorch device_name: cuda:0
2025-05-06 16:19:33,980 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-05-06 16:19:35,732 - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-05-06 16:19:39,182 - INFO - Loading HotpotQA dataset with split: test
2025-05-06 16:19:41,179 - INFO - Loading PubMedQA dataset with split: test
2025-05-06 16:19:42,743 - INFO - Dataset Loading Duration: 3.56s
2025-05-06 16:19:43,779 - INFO - HotpotQA Test Split: 390 entries, 1557 docs, 0.73 MB
2025-05-06 16:19:43,779 - INFO - PubMedQA Test Split: 2450 entries, 12250 docs, 4.31 MB
2025-05-06 16:19:43,779 - INFO - Combined Dataset: 2840 entries, 13807 docs, 5.04 MB
2025-05-06 16:19:44,897 - INFO - Document Collection Duration: 1.12s
2025-05-06 16:19:44,897 - INFO - Total Documents to Embed: 13807
2025-05-06 16:19:44,897 - INFO - Using sequential embedding mode
2025-05-06 16:22:15,291 - INFO - Sequential Embedding Duration: 150.39s
2025-05-06 16:22:15,291 - INFO - Total Query Preprocessing: 0.00s
2025-05-06 16:22:15,291 - INFO - Total Query Encoding: 148.40s
2025-05-06 16:22:15,295 - INFO - Average Embedding Norm: 1.0000 ± 0.0000
Embedding Generation - Duration: 150.40s, CPU Time Delta: 212.08s, CPU: 0.00%, Memory: 3886.52 MB
2025-05-06 16:22:16,296 - INFO - Attempting to connect to MongoDB at mongodb://localhost:32768/?directConnection=true (Attempt 1/5)
2025-05-06 16:22:16,300 - INFO - Connected to MongoDB successfully!
2025-05-06 16:22:16,413 - INFO - Database Clearing Duration: 0.11s
2025-05-06 16:22:16,413 - INFO - Inserting documents in batch into MongoDB
2025-05-06 16:22:18,429 - INFO - Batch Document Storage Duration: 2.02s
2025-05-06 16:22:18,429 - INFO - Setting up vector index
2025-05-06 16:22:18,533 - INFO - Existing 'vector_index' dropped.
2025-05-06 16:22:18,546 - INFO - Waiting for vector index to be ready...
2025-05-06 16:22:28,964 - INFO - Vector index is now ready!
2025-05-06 16:22:28,964 - INFO - Document Indexing Duration: 10.54s
Embedding and Storage - Duration: 12.67s, CPU Time Delta: 1.17s, CPU: 0.00%, Memory: 3886.52 MB
After Index Setup - CPU: 0.00%, CPU Time: 10792.25s, Memory: 3886.52 MB
2025-05-06 16:22:30,976 - INFO - Stored 13807 documents in batch, 13807 entries in MongoDB.
Data Load (sequential) - Duration: 171.90s, CPU Time Delta: 215.77s, CPU: 0.00%, Memory: 3672.39 MB
2025-05-06 16:22:32,086 - INFO - 
Running evaluation (30 candidates, sequential)...
2025-05-06 16:22:32,086 - INFO - Starting evaluation with 2840 queries, 4 workers, 30 candidates

2025-05-06 16:24:10,740 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 16:24:10,740 - INFO - Database Size: 136.48 MB (13807 documents)
2025-05-06 16:24:10,740 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 16:24:10,740 - INFO - Average Precision: 94.08% (8016/8520 docs)
2025-05-06 16:24:10,740 - INFO - Average Latency: 0.1355 seconds/query
2025-05-06 16:24:10,740 - INFO - Throughput: 28.79 queries/second (with 4 workers, 30 candidates)
Evaluation (30 candidates, sequential) - Duration: 98.66s, CPU Time Delta: 148.83s, CPU: 0.00%, Memory: 3670.03 MB
2025-05-06 16:24:11,748 - INFO - 
Running evaluation (100 candidates, sequential)...
2025-05-06 16:24:11,749 - INFO - Starting evaluation with 2840 queries, 4 workers, 100 candidates
2025-05-06 16:25:49,207 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 16:25:49,207 - INFO - Database Size: 136.48 MB (13807 documents)
2025-05-06 16:25:49,207 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 16:25:49,207 - INFO - Average Precision: 94.39% (8042/8520 docs)
2025-05-06 16:25:49,207 - INFO - Average Latency: 0.1337 seconds/query
2025-05-06 16:25:49,207 - INFO - Throughput: 29.15 queries/second (with 4 workers, 100 candidates)
Evaluation (100 candidates, sequential) - Duration: 97.47s, CPU Time Delta: 146.26s, CPU: 0.00%, Memory: 3673.06 MB
2025-05-06 16:25:50,216 - INFO - Running batch embedding mode
2025-05-06 16:25:50,218 - INFO - Use pytorch device_name: cuda:0
2025-05-06 16:25:50,218 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-05-06 16:25:51,633 - INFO - Loading HotpotQA dataset with split: test
2025-05-06 16:25:53,490 - INFO - Loading PubMedQA dataset with split: test
2025-05-06 16:25:55,097 - INFO - Dataset Loading Duration: 3.46s
2025-05-06 16:25:56,164 - INFO - HotpotQA Test Split: 390 entries, 1557 docs, 0.73 MB
2025-05-06 16:25:56,164 - INFO - PubMedQA Test Split: 2450 entries, 12250 docs, 4.31 MB
2025-05-06 16:25:56,164 - INFO - Combined Dataset: 2840 entries, 13807 docs, 5.04 MB
2025-05-06 16:25:57,294 - INFO - Document Collection Duration: 1.13s
2025-05-06 16:25:57,294 - INFO - Total Documents to Embed: 13807
2025-05-06 16:25:57,294 - INFO - Using batch embedding mode
2025-05-06 16:26:45,501 - INFO - Batch Embedding Duration: 48.21s
2025-05-06 16:26:45,501 - INFO - Total Query Preprocessing: 0.00s
2025-05-06 16:26:45,501 - INFO - Total Query Encoding: 23.04s
2025-05-06 16:26:45,502 - INFO - Average Embedding Norm: 1.0000 ± 0.0000
Embedding Generation - Duration: 48.21s, CPU Time Delta: 63.02s, CPU: 0.00%, Memory: 3911.42 MB
2025-05-06 16:26:46,504 - INFO - Attempting to connect to MongoDB at mongodb://localhost:32768/?directConnection=true (Attempt 1/5)
2025-05-06 16:26:46,508 - INFO - Connected to MongoDB successfully!
2025-05-06 16:26:46,639 - INFO - Database Clearing Duration: 0.13s
2025-05-06 16:26:46,639 - INFO - Inserting documents in batch into MongoDB
2025-05-06 16:26:48,619 - INFO - Batch Document Storage Duration: 1.98s
2025-05-06 16:26:48,619 - INFO - Setting up vector index
2025-05-06 16:26:50,280 - INFO - Existing 'vector_index' dropped.
2025-05-06 16:26:50,303 - INFO - Waiting for vector index to be ready...
2025-05-06 16:27:00,717 - INFO - Vector index is now ready!
2025-05-06 16:27:00,717 - INFO - Document Indexing Duration: 12.10s
Embedding and Storage - Duration: 14.21s, CPU Time Delta: 0.99s, CPU: 0.00%, Memory: 3912.49 MB
After Index Setup - CPU: 0.00%, CPU Time: 11154.13s, Memory: 3912.49 MB
2025-05-06 16:27:02,728 - INFO - Stored 13807 documents in batch, 13807 entries in MongoDB.
Data Load (batch) - Duration: 71.20s, CPU Time Delta: 66.57s, CPU: 0.00%, Memory: 3686.22 MB
2025-05-06 16:27:03,837 - INFO - 
Running evaluation (30 candidates, batch)...
2025-05-06 16:27:03,837 - INFO - Starting evaluation with 2840 queries, 4 workers, 30 candidates
2025-05-06 16:28:42,251 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 16:28:42,251 - INFO - Database Size: 136.48 MB (13807 documents)
2025-05-06 16:28:42,251 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 16:28:42,251 - INFO - Average Precision: 94.06% (8014/8520 docs)
2025-05-06 16:28:42,251 - INFO - Average Latency: 0.1351 seconds/query
2025-05-06 16:28:42,251 - INFO - Throughput: 28.86 queries/second (with 4 workers, 30 candidates)
Evaluation (30 candidates, batch) - Duration: 98.42s, CPU Time Delta: 148.47s, CPU: 0.00%, Memory: 3677.50 MB
2025-05-06 16:28:43,261 - INFO - 
Running evaluation (100 candidates, batch)...
2025-05-06 16:28:43,261 - INFO - Starting evaluation with 2840 queries, 4 workers, 100 candidates
2025-05-06 16:30:20,868 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 16:30:20,868 - INFO - Database Size: 136.48 MB (13807 documents)
2025-05-06 16:30:20,868 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 16:30:20,868 - INFO - Average Precision: 94.38% (8041/8520 docs)
2025-05-06 16:30:20,868 - INFO - Average Latency: 0.1339 seconds/query
2025-05-06 16:30:20,868 - INFO - Throughput: 29.10 queries/second (with 4 workers, 100 candidates)
Evaluation (100 candidates, batch) - Duration: 97.61s, CPU Time Delta: 146.35s, CPU: 0.00%, Memory: 3677.60 MB
2025-05-06 16:30:21,878 - INFO - 
=== Summary for Model: sentence-transformers/all-mpnet-base-v2 (Sequential Embedding) ===
2025-05-06 16:30:21,878 - INFO - Model Specs:
2025-05-06 16:30:21,878 - INFO -   Parameters: 110,000,000 (~110M)
2025-05-06 16:30:21,878 - INFO -   Embedding Size: 768
2025-05-06 16:30:21,878 - INFO - 
Dataset and Database Statistics:
2025-05-06 16:30:21,878 - INFO - Metric                                   Value               
2025-05-06 16:30:21,878 - INFO - ------------------------------------------------------------
2025-05-06 16:30:21,878 - INFO - HotpotQA Entries                         390                 
2025-05-06 16:30:21,878 - INFO - PubMedQA Entries                         2450                
2025-05-06 16:30:21,878 - INFO - Total Dataset Entries                    2840                
2025-05-06 16:30:21,878 - INFO - HotpotQA Documents                       1557                
2025-05-06 16:30:21,878 - INFO - PubMedQA Documents                       12250               
2025-05-06 16:30:21,878 - INFO - Total Documents                          13807               
2025-05-06 16:30:21,878 - INFO - HotpotQA Size (MB)                       0.73                
2025-05-06 16:30:21,879 - INFO - PubMedQA Size (MB)                       4.31                
2025-05-06 16:30:21,879 - INFO - Total Dataset Size (MB)                  5.04                
2025-05-06 16:30:21,879 - INFO - Documents Stored (Batch)                 13807               
2025-05-06 16:30:21,879 - INFO - Database Entries                         13807               
2025-05-06 16:30:21,879 - INFO - Database Size (MB)                       136.48              
2025-05-06 16:30:21,879 - INFO - Total Queries Evaluated                  2840                
2025-05-06 16:30:21,879 - INFO - Embedding Mode                           sequential          
2025-05-06 16:30:21,879 - INFO - 
Timing Breakdown (Total Time: 1272.26s):
2025-05-06 16:30:21,879 - INFO - Process                                  Time (s)     Proportion (%) 
2025-05-06 16:30:21,879 - INFO - -------------------------------------------------------------------
2025-05-06 16:30:21,879 - INFO - Database Connection                      0.00         0.00           
2025-05-06 16:30:21,879 - INFO - Dataset Loading                          3.56         0.28           
2025-05-06 16:30:21,879 - INFO - Document Collection                      1.12         0.09           
2025-05-06 16:30:21,879 - INFO - Database Clearing                        0.11         0.01           
2025-05-06 16:30:21,879 - INFO - Sequential Embedding                     150.39       11.82          
2025-05-06 16:30:21,879 - INFO - Embedding Generation (Document)          150.40       11.82          
2025-05-06 16:30:21,879 - INFO - Batch Document Storage                   2.02         0.16           
2025-05-06 16:30:21,879 - INFO - Document Indexing                        10.54        0.83           
2025-05-06 16:30:21,879 - INFO - Query Preprocessing (30 candidates)      0.00         0.00           
2025-05-06 16:30:21,879 - INFO - Query Encoding (30 candidates)           369.00       29.00          
2025-05-06 16:30:21,879 - INFO - Vector Similarity Search (30 candidates) 12.55        0.99           
2025-05-06 16:30:21,879 - INFO - Evaluation Overhead (30 candidates)      98.64        7.75           
2025-05-06 16:30:21,879 - INFO - Query Preprocessing (100 candidates)     0.00         0.00           
2025-05-06 16:30:21,879 - INFO - Query Encoding (100 candidates)          354.48       27.86          
2025-05-06 16:30:21,879 - INFO - Vector Similarity Search (100 candidates) 22.02        1.73           
2025-05-06 16:30:21,879 - INFO - Evaluation Overhead (100 candidates)     97.44        7.66           
2025-05-06 16:30:21,879 - INFO - 
Evaluation Metrics (30 candidates):
2025-05-06 16:30:21,879 - INFO -   Latency (s/query): 0.1355
2025-05-06 16:30:21,879 - INFO -   Throughput (q/s): 28.79
2025-05-06 16:30:21,879 - INFO -   Precision (%): 94.08
2025-05-06 16:30:21,879 - INFO - 
Evaluation Metrics (100 candidates):
2025-05-06 16:30:21,879 - INFO -   Latency (s/query): 0.1337
2025-05-06 16:30:21,879 - INFO -   Throughput (q/s): 29.15
2025-05-06 16:30:21,879 - INFO -   Precision (%): 94.39
