=== Evaluating Model: meta-llama/Meta-Llama-3.1-8B ===
2025-05-06 13:50:38,219 - INFO - Running sequential embedding mode
Set pad_token to eos_token: <|eot_id|>
2025-05-06 13:52:10,603 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-05-06 13:55:10,837 - INFO - Loading HotpotQA dataset with split: test
2025-05-06 13:55:13,335 - INFO - Loading PubMedQA dataset with split: test
2025-05-06 13:55:15,066 - INFO - Dataset Loading Duration: 4.23s
2025-05-06 13:55:16,135 - INFO - HotpotQA Test Split: 390 entries, 1557 docs, 0.73 MB
2025-05-06 13:55:16,135 - INFO - PubMedQA Test Split: 2450 entries, 12250 docs, 4.31 MB
2025-05-06 13:55:16,135 - INFO - Combined Dataset: 2840 entries, 13807 docs, 5.04 MB
2025-05-06 13:55:17,270 - INFO - Document Collection Duration: 1.13s
2025-05-06 13:55:17,270 - INFO - Total Documents to Embed: 13807
2025-05-06 13:55:17,270 - INFO - Using sequential embedding mode
2025-05-06 14:16:26,947 - INFO - Sequential Embedding Duration: 1269.68s
2025-05-06 14:16:26,947 - INFO - Total Query Preprocessing: 7.77s
2025-05-06 14:16:26,947 - INFO - Total Query Encoding: 814.52s
2025-05-06 14:16:26,953 - INFO - Average Embedding Norm: 45.9167 ± 3.2064
Embedding Generation - Duration: 1269.68s, CPU Time Delta: 1268.87s, CPU: 0.00%, Memory: 3961.05 MB
2025-05-06 14:16:27,954 - INFO - Attempting to connect to MongoDB at mongodb://localhost:32768/?directConnection=true (Attempt 1/5)
2025-05-06 14:16:27,964 - INFO - Connected to MongoDB successfully!
2025-05-06 14:16:28,190 - INFO - Database Clearing Duration: 0.23s
2025-05-06 14:16:28,190 - INFO - Inserting documents in batch into MongoDB
2025-05-06 14:16:39,444 - INFO - Batch Document Storage Duration: 11.25s
2025-05-06 14:16:39,482 - INFO - Setting up vector index
2025-05-06 14:16:40,121 - INFO - Existing 'vector_index' dropped.
2025-05-06 14:16:40,402 - INFO - Waiting for vector index to be ready...
2025-05-06 14:17:05,853 - INFO - Vector index is now ready!
2025-05-06 14:17:05,853 - INFO - Document Indexing Duration: 26.37s
Embedding and Storage - Duration: 37.90s, CPU Time Delta: 4.58s, CPU: 0.00%, Memory: 4069.54 MB
After Index Setup - CPU: 0.00%, CPU Time: 1323.83s, Memory: 4069.54 MB
2025-05-06 14:17:07,868 - INFO - Stored 13807 documents in batch, 13807 entries in MongoDB.
Data Load (sequential) - Duration: 1317.50s, CPU Time Delta: 1276.46s, CPU: 0.00%, Memory: 2432.91 MB
2025-05-06 14:17:09,336 - INFO - 
Running evaluation (30 candidates, sequential)...
2025-05-06 14:17:09,336 - INFO - Starting evaluation with 2840 queries, 4 workers, 30 candidates
2025-05-06 14:24:43,408 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 14:24:43,408 - INFO - Database Size: 746.92 MB (13807 documents)
2025-05-06 14:24:43,408 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 14:24:43,408 - INFO - Average Precision: 55.67% (4743/8520 docs)
2025-05-06 14:24:43,408 - INFO - Average Latency: 0.6356 seconds/query
2025-05-06 14:24:43,408 - INFO - Throughput: 6.25 queries/second (with 4 workers, 30 candidates)
Evaluation (30 candidates, sequential) - Duration: 454.08s, CPU Time Delta: 734.63s, CPU: 0.00%, Memory: 2428.95 MB
2025-05-06 14:24:44,417 - INFO - 
Running evaluation (100 candidates, sequential)...
2025-05-06 14:24:44,417 - INFO - Starting evaluation with 2840 queries, 4 workers, 100 candidates
2025-05-06 14:31:40,405 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 14:31:40,405 - INFO - Database Size: 746.92 MB (13807 documents)
2025-05-06 14:31:40,405 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 14:31:40,405 - INFO - Average Precision: 56.08% (4778/8520 docs)
2025-05-06 14:31:40,405 - INFO - Average Latency: 0.5817 seconds/query
2025-05-06 14:31:40,405 - INFO - Throughput: 6.83 queries/second (with 4 workers, 100 candidates)
Evaluation (100 candidates, sequential) - Duration: 415.99s, CPU Time Delta: 658.79s, CPU: 0.00%, Memory: 2426.04 MB
2025-05-06 14:31:41,414 - INFO - Running batch embedding mode
Set pad_token to eos_token: <|eot_id|>
2025-05-06 14:31:44,805 - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:31<01:33, 31.22s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [01:03<01:04, 32.02s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [01:39<00:33, 33.93s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [01:41<00:00, 21.02s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [01:41<00:00, 25.31s/it]
2025-05-06 14:33:26,378 - INFO - Loading HotpotQA dataset with split: test
2025-05-06 14:33:28,480 - INFO - Loading PubMedQA dataset with split: test
2025-05-06 14:33:30,219 - INFO - Dataset Loading Duration: 3.84s
2025-05-06 14:33:31,370 - INFO - HotpotQA Test Split: 390 entries, 1557 docs, 0.73 MB
2025-05-06 14:33:31,370 - INFO - PubMedQA Test Split: 2450 entries, 12250 docs, 4.31 MB
2025-05-06 14:33:31,370 - INFO - Combined Dataset: 2840 entries, 13807 docs, 5.04 MB
2025-05-06 14:33:32,557 - INFO - Document Collection Duration: 1.19s
2025-05-06 14:33:32,558 - INFO - Total Documents to Embed: 13807
2025-05-06 14:33:32,558 - INFO - Using batch embedding mode
2025-05-06 14:45:42,265 - INFO - Batch Embedding Duration: 729.71s
2025-05-06 14:45:42,266 - INFO - Total Query Preprocessing: 3.98s
2025-05-06 14:45:42,266 - INFO - Total Query Encoding: 368.77s
2025-05-06 14:45:42,269 - INFO - Average Embedding Norm: 45.4771 ± 3.1080
Embedding Generation - Duration: 729.71s, CPU Time Delta: 732.12s, CPU: 0.00%, Memory: 4436.68 MB
2025-05-06 14:45:43,270 - INFO - Attempting to connect to MongoDB at mongodb://localhost:32768/?directConnection=true (Attempt 1/5)
2025-05-06 14:45:43,276 - INFO - Connected to MongoDB successfully!
2025-05-06 14:45:43,472 - INFO - Database Clearing Duration: 0.20s
2025-05-06 14:45:43,472 - INFO - Inserting documents in batch into MongoDB
2025-05-06 14:46:04,641 - INFO - Batch Document Storage Duration: 21.17s
2025-05-06 14:46:04,641 - INFO - Setting up vector index
2025-05-06 14:46:39,773 - INFO - Existing 'vector_index' dropped.
2025-05-06 14:46:39,800 - INFO - Waiting for vector index to be ready...
2025-05-06 14:47:10,283 - INFO - Vector index is now ready!
2025-05-06 14:47:10,283 - INFO - Document Indexing Duration: 65.64s
Embedding and Storage - Duration: 87.01s, CPU Time Delta: 5.44s, CPU: 0.00%, Memory: 4554.59 MB
After Index Setup - CPU: 0.00%, CPU Time: 3470.99s, Memory: 4554.59 MB
2025-05-06 14:47:12,423 - INFO - Stored 13807 documents in batch, 13807 entries in MongoDB.
Data Load (batch) - Duration: 826.54s, CPU Time Delta: 740.72s, CPU: 0.00%, Memory: 2964.23 MB
2025-05-06 14:47:13,919 - INFO - 
Running evaluation (30 candidates, batch)...
2025-05-06 14:47:13,919 - INFO - Starting evaluation with 2840 queries, 4 workers, 30 candidates
2025-05-06 14:54:20,897 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 14:54:20,897 - INFO - Database Size: 746.92 MB (13807 documents)
2025-05-06 14:54:20,897 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 14:54:20,897 - INFO - Average Precision: 56.35% (4801/8520 docs)
2025-05-06 14:54:20,897 - INFO - Average Latency: 0.5973 seconds/query
2025-05-06 14:54:20,897 - INFO - Throughput: 6.65 queries/second (with 4 workers, 30 candidates)
Evaluation (30 candidates, batch) - Duration: 426.99s, CPU Time Delta: 675.69s, CPU: 0.00%, Memory: 2943.78 MB
2025-05-06 14:54:21,907 - INFO - 
Running evaluation (100 candidates, batch)...
2025-05-06 14:54:21,908 - INFO - Starting evaluation with 2840 queries, 4 workers, 100 candidates
2025-05-06 15:01:51,003 - INFO - 
=== Retrieval Performance Summary ===
2025-05-06 15:01:51,003 - INFO - Database Size: 746.92 MB (13807 documents)
2025-05-06 15:01:51,003 - INFO - Retrieval Success: 100.00% (2840/2840 queries)
2025-05-06 15:01:51,003 - INFO - Average Precision: 56.67% (4828/8520 docs)
2025-05-06 15:01:51,003 - INFO - Average Latency: 0.6286 seconds/query
2025-05-06 15:01:51,003 - INFO - Throughput: 6.32 queries/second (with 4 workers, 100 candidates)
Evaluation (100 candidates, batch) - Duration: 449.10s, CPU Time Delta: 720.64s, CPU: 0.00%, Memory: 2941.83 MB
2025-05-06 15:01:52,035 - INFO - 
=== Summary for Model: meta-llama/Meta-Llama-3.1-8B (Sequential Embedding) ===
2025-05-06 15:01:52,035 - INFO - Model Specs:
2025-05-06 15:01:52,035 - INFO -   Parameters: 8,000,000,000 (~8000M)
2025-05-06 15:01:52,035 - INFO -   Embedding Size: 4096
2025-05-06 15:01:52,035 - INFO - 
Dataset and Database Statistics:
2025-05-06 15:01:52,035 - INFO - Metric                                   Value               
2025-05-06 15:01:52,035 - INFO - ------------------------------------------------------------
2025-05-06 15:01:52,035 - INFO - HotpotQA Entries                         390                 
2025-05-06 15:01:52,035 - INFO - PubMedQA Entries                         2450                
2025-05-06 15:01:52,035 - INFO - Total Dataset Entries                    2840                
2025-05-06 15:01:52,035 - INFO - HotpotQA Documents                       1557                
2025-05-06 15:01:52,035 - INFO - PubMedQA Documents                       12250               
2025-05-06 15:01:52,035 - INFO - Total Documents                          13807               
2025-05-06 15:01:52,035 - INFO - HotpotQA Size (MB)                       0.73                
2025-05-06 15:01:52,036 - INFO - PubMedQA Size (MB)                       4.31                
2025-05-06 15:01:52,036 - INFO - Total Dataset Size (MB)                  5.04                
2025-05-06 15:01:52,036 - INFO - Documents Stored (Batch)                 13807               
2025-05-06 15:01:52,036 - INFO - Database Entries                         13807               
2025-05-06 15:01:52,036 - INFO - Database Size (MB)                       746.92              
2025-05-06 15:01:52,036 - INFO - Total Queries Evaluated                  2840                
2025-05-06 15:01:52,036 - INFO - Embedding Mode                           sequential          
2025-05-06 15:01:52,036 - INFO - 
Timing Breakdown (Total Time: 6880.99s):
2025-05-06 15:01:52,036 - INFO - Process                                  Time (s)     Proportion (%) 
2025-05-06 15:01:52,036 - INFO - -------------------------------------------------------------------
2025-05-06 15:01:52,036 - INFO - Database Connection                      0.01         0.00           
2025-05-06 15:01:52,036 - INFO - Dataset Loading                          4.23         0.06           
2025-05-06 15:01:52,036 - INFO - Document Collection                      1.13         0.02           
2025-05-06 15:01:52,036 - INFO - Database Clearing                        0.23         0.00           
2025-05-06 15:01:52,036 - INFO - Sequential Embedding                     1269.68      18.45          
2025-05-06 15:01:52,036 - INFO - Embedding Generation (Document)          1269.68      18.45          
2025-05-06 15:01:52,036 - INFO - Batch Document Storage                   11.25        0.16           
2025-05-06 15:01:52,036 - INFO - Document Indexing                        26.37        0.38           
2025-05-06 15:01:52,036 - INFO - Query Preprocessing (30 candidates)      7.10         0.10           
2025-05-06 15:01:52,036 - INFO - Query Encoding (30 candidates)           1724.97      25.07          
2025-05-06 15:01:52,036 - INFO - Vector Similarity Search (30 candidates) 57.89        0.84           
2025-05-06 15:01:52,036 - INFO - Evaluation Overhead (30 candidates)      454.05       6.60           
2025-05-06 15:01:52,037 - INFO - Query Preprocessing (100 candidates)     5.00         0.07           
2025-05-06 15:01:52,037 - INFO - Query Encoding (100 candidates)          1540.18      22.38          
2025-05-06 15:01:52,037 - INFO - Vector Similarity Search (100 candidates) 93.25        1.36           
2025-05-06 15:01:52,037 - INFO - Evaluation Overhead (100 candidates)     415.96       6.05           
2025-05-06 15:01:52,037 - INFO - 
Evaluation Metrics (30 candidates):
2025-05-06 15:01:52,037 - INFO -   Latency (s/query): 0.6356
2025-05-06 15:01:52,037 - INFO -   Throughput (q/s): 6.25
2025-05-06 15:01:52,037 - INFO -   Precision (%): 55.67
2025-05-06 15:01:52,037 - INFO - 
Evaluation Metrics (100 candidates):
2025-05-06 15:01:52,037 - INFO -   Latency (s/query): 0.5817
2025-05-06 15:01:52,037 - INFO -   Throughput (q/s): 6.83
2025-05-06 15:01:52,037 - INFO -   Precision (%): 56.08
